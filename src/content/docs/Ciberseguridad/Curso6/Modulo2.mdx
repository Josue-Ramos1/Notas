---
title: Curso 6 - M√≥dulo 2 Monitoreo y An√°lisis de Redes
description: Conceptos y herramientas clave para supervisar y proteger el tr√°fico en redes.
---

import { CardGrid, Card, Aside, Steps, Tabs, Code  } from '@astrojs/starlight/components'

# Comprender el tr√°fico en la red

## Supervisi√≥n del tr√°fico de red y detecci√≥n de anomal√≠as

En un entorno digital cada vez m√°s interconectado, los datos suelen viajar a trav√©s de m√∫ltiples redes, pa√≠ses y dispositivos. Esta complejidad aumenta el riesgo de que la informaci√≥n sea enviada o almacenada en ubicaciones no seguras, como cuentas personales o servicios en la nube sin protecci√≥n.  
Los profesionales de ciberseguridad son responsables de **garantizar la protecci√≥n de las comunicaciones tanto en tr√°nsito como en reposo**.

---

### Tr√°fico de red: concepto general

El **tr√°fico de red** se refiere a la cantidad de datos que circulan a trav√©s de una red en un momento determinado.

<CardGrid>
  <Card>  
    **Datos de red:** paquetes o flujos de informaci√≥n transmitidos entre dispositivos conectados.
  </Card>
  <Card>  
    En grandes organizaciones, puede haber miles de usuarios intercambiando datos simult√°neamente.
  </Card>
</CardGrid>

---

### An√°lisis del tr√°fico de red

Debido al gran volumen, es vital **distinguir entre comportamientos normales y an√≥malos**.

<Aside type="tip">
Analog√≠a: As√≠ como reconocemos un embotellamiento inusual en el tr√°fico vehicular, en la red tambi√©n se pueden identificar <strong>anomal√≠as</strong> comparando con el flujo habitual.
</Aside>

---

### Detecci√≥n de anomal√≠as e indicadores de compromiso (IoC)

Conocer el flujo esperado permite identificar desviaciones sospechosas, que pueden contener **indicadores de compromiso (IoC)**, se√±ales de posibles incidentes.

<Card>
  <strong>Ejemplo: Exfiltraci√≥n de datos</strong><br/>
  Salida no autorizada de informaci√≥n confidencial.  
  Un IoC t√≠pico es un volumen inusualmente alto de tr√°fico saliente desde un solo dispositivo.
</Card>

---

### Importancia para la ciberseguridad

La vigilancia constante del tr√°fico de red:

- Detecta incidentes tempranamente.  
- Previene p√©rdidas de datos.  
- Facilita investigaciones en tiempo real.

---

## Supervisi√≥n y protecci√≥n de redes

Conocer y monitorear la red es esencial para identificar actividades an√≥malas y proteger las comunicaciones.

---

### Conozca su red

Las redes se comunican mediante **protocolos** que generan datos √∫tiles, por ejemplo:

<CardGrid>
  <Card>Direcciones IP de origen y destino</Card>
  <Card>Fecha y hora de transmisi√≥n</Card>
  <Card>Cantidad de datos transferidos</Card>
</CardGrid>

Esta informaci√≥n ayuda a establecer una **l√≠nea de base** del comportamiento normal.

<Aside type="note">
<strong>¬øQu√© es una l√≠nea de base?</strong>  
Un punto de referencia para comparar el comportamiento actual frente a lo esperado.  
Ejemplo: tr√°fico de red normal entre 9 a.m. y 5 p.m. en una empresa.
</Aside>

---

### Monitoree su red

Con la l√≠nea de base definida, se monitorean componentes clave para detectar desviaciones:

<Steps>
1. **An√°lisis de flujo (Network Flow):** movimiento de datos, protocolos, puertos.  
2. **Carga √∫til de paquetes:** contenido real de los datos, analizable si se desencripta.  
3. **Patrones temporales:** actividad fuera del horario habitual puede ser sospechosa.
</Steps>

---

### Proteja su red

<CardGrid>
  <Card>
    <strong>SOC (Security Operations Center):</strong> enfocado en seguridad y respuesta a amenazas.
  </Card>
  <Card>
    <strong>NOC (Network Operations Center):</strong> enfocado en rendimiento y disponibilidad de red.
  </Card>
</CardGrid>

El analista debe supervisar tr√°fico, detectar IoC, investigar y responder a incidentes.

---

### Herramientas de monitoreo de red

Monitoreo puede ser:

* **Automatizado:** con sistemas de alerta.  
* **Manual:** an√°lisis detallado del tr√°fico.

Herramientas comunes:

<CardGrid>
  <Card>
    <strong>IDS (Intrusion Detection System):</strong> monitorea actividad y alerta ante patrones conocidos.
  </Card>
  <Card>
    <strong>Analizadores de protocolos (packet sniffers):</strong> capturan y analizan tr√°fico, ej. Wireshark, tcpdump.
  </Card>
</CardGrid>

---

## Detecci√≥n y respuesta ante ataques de exfiltraci√≥n de datos

Supervisar el tr√°fico permite anticipar y actuar r√°pido ante intentos de robo de informaci√≥n, incluso si los datos est√°n cifrados.

---

### Perspectiva del atacante

<Steps>
1. **Acceso inicial:** suele lograrse mediante ingenier√≠a social, como phishing.  
2. **Movimiento lateral:** explora otros sistemas sin ser detectado.  
3. **Reconocimiento de activos:** busca datos valiosos como c√≥digo, datos personales, registros financieros.  
4. **Preparaci√≥n para exfiltraci√≥n:** comprime o fragmenta datos para evadir controles.  
5. **Exfiltraci√≥n:** env√≠a datos fuera de la red, usando canales cifrados o cuentas comprometidas.
</Steps>

---

### Defensa de la organizaci√≥n

Medidas proactivas y reactivas:

<CardGrid>
  <Card>
    **Prevenci√≥n de acceso:**  
    Autenticaci√≥n multifactor (MFA) y capacitaci√≥n contra phishing.
  </Card>
  <Card>
    **Monitoreo:**  
    Vigilancia continua de patrones an√≥malos, picos inusuales y accesos extra√±os.
  </Card>
  <Card>
    **Inventario y controles:**  
    Mantener activos actualizados y aplicar controles de acceso.
  </Card>
  <Card>
    **Detecci√≥n y respuesta:**  
    Identificar IoC, usar SIEM para alertas, bloquear IPs y aplicar reglas de firewall.
  </Card>
</CardGrid>

# Captura y visualizaci√≥n del tr√°fico en la red

## Introducci√≥n a la Captura y An√°lisis de Tr√°fico de Red

### Importancia del an√°lisis de tr√°fico

Toda acci√≥n en una red deja rastros que pueden identificarse analizando el flujo de tr√°fico. Esto permite:

- Obtener informaci√≥n estad√≠stica valiosa.  
- Mejorar la visibilidad del entorno.  
- Detectar y defenderse de amenazas.

---

### Estructura de un paquete de red

Los datos se env√≠an en **paquetes**, como sobres postales que contienen:

<CardGrid>
  <Card>
    <strong>Encabezado:</strong> info t√©cnica (IP origen/destino, protocolo, puerto).
  </Card>
  <Card>
    <strong>Carga √∫til (Payload):</strong> datos reales transmitidos.
  </Card>
  <Card>
    <strong>Pie de p√°gina (Footer):</strong> indica el final del paquete.
  </Card>
</CardGrid>

---

### Conceptos clave

- **Protocolos de red:** reglas para transmisi√≥n entre dispositivos.  
- **Puertos:** puntos l√≥gicos que organizan comunicaciones.

---

### Herramientas de an√°lisis: Rastreadores de paquetes

Un **packet sniffer** captura y analiza tr√°fico para identificar anomal√≠as o indicadores de compromiso.

---

### Capturas de paquetes (P-cap)

Archivos que almacenan paquetes interceptados para an√°lisis detallado e investigaci√≥n.

---

## Captura y An√°lisis de Tr√°fico de Red: Fundamentos y Herramientas

### Funci√≥n del analista de seguridad

Supervisa flujos y analiza paquetes para detectar anomal√≠as y comprender actividades en la red.

---

### Paquetes de red

Unidad fundamental de datos que viaja en la red.

<Tabs>
  <div title="Componentes de un paquete">
    <Steps>
    1. **Cabecera (Header):** info para enrutamiento (IP, protocolo, longitud, etc.)  
    2. **Carga √∫til (Payload):** datos transmitidos (ej. imagen)  
    3. **Pie de p√°gina (Footer):** verificaci√≥n de errores (en protocolos como Ethernet)  
    </Steps>
  </div>
  <div title="Ejemplos de encabezados">
    - Ethernet  
    - IP (IPv4, IPv6)  
    - TCP, UDP  
  </div>
</Tabs>

---

### Analizadores de protocolos de red

Herramientas para capturar y examinar tr√°fico.

<CardGrid>
  <Card>
    <strong>Usos leg√≠timos:</strong> seguridad, estad√≠sticas, resoluci√≥n de problemas.
  </Card>
  <Card>
    <strong>Ejemplos:</strong> tcpdump, Wireshark, TShark.
  </Card>
  <Card>
    <strong>Riesgos:</strong> pueden usarse maliciosamente, su uso requiere √©tica y autorizaci√≥n.
  </Card>
</CardGrid>

---

### Funcionamiento de los analizadores

- Capturan tr√°fico mediante la tarjeta de red (NIC).  
- NIC en modo promiscuo o monitor permite captar todo el tr√°fico visible.  
- Paquetes binarios se traducen a formato legible para an√°lisis.

<Aside type="caution">
‚ö†Ô∏è El modo promiscuo puede exponer a riesgos si no se usa con cuidado.
</Aside>

---

### Capturas de paquetes (P-cap)

Archivos que almacenan paquetes interceptados.

<CardGrid>
  <Card>
    Pueden filtrarse para mostrar s√≥lo datos relevantes.
  </Card>
  <Card>
    Ayudan a reconstruir eventos de seguridad.
  </Card>
  <Card>
    Su interceptaci√≥n sin autorizaci√≥n suele ser ilegal.
  </Card>
</CardGrid>

| Biblioteca/Formato | Sistema Operativo | Descripci√≥n                             |
|--------------------|-------------------|---------------------------------------|
| Libpcap            | Unix/Linux/macOS  | Formato com√∫n usado por tcpdump        |
| WinPcap            | Windows           | Obsoleta, est√°ndar en sistemas antiguos|
| Npcap              | Windows           | Reemplazo moderno usado por Nmap       |
| PCAPng              | Multiplataforma    | Next Generation, captura simult√°nea    |

<Aside type="tip">
üí° Practicar con tu red dom√©stica es excelente para aprender.
</Aside>

---

## An√°lisis Manual de Paquetes: Encabezados IP

### Introducci√≥n

Aprender a leer paquetes manualmente mejora la comprensi√≥n y detecci√≥n de anomal√≠as.

---

### Modelo TCP/IP y Capa de Internet

- La Capa de Internet gestiona la entrega de paquetes.  
- El Protocolo IP determina la ruta eficiente para llegar a destino.

---

### Versiones IP

- IPv4: versi√≥n predominante.  
- IPv6: versi√≥n moderna con m√°s capacidad y seguridad.

Este m√≥dulo se enfoca en encabezados **IPv4**.

---

### Campos del Encabezado IPv4

| Campo                            | Descripci√≥n                                                      |
|---------------------------------|-----------------------------------------------------------------|
| **Versi√≥n**                     | Versi√≥n del protocolo (IPv4). Como clase postal.                |
| **IHL (Internet Header Length)**| Longitud del encabezado IP.                                     |
| **ToS (Type of Service)**       | Prioridad o tratamiento especial (ej. etiqueta ‚Äúfr√°gil‚Äù).       |
| **Longitud Total**              | Tama√±o total del paquete (sobre).                               |
| **Identificaci√≥n, Indicadores, Desfase de Fragmentos** | Manejo de fragmentaci√≥n y reensamblado.         |
| **TTL (Time to Live)**          | Vida √∫til del paquete para evitar ciclos infinitos.             |
| **Protocolo**                   | Protocolo superior (ej. TCP=6).                                 |
| **Suma de Comprobaci√≥n del Encabezado** | Verificaci√≥n de integridad del encabezado.                |
| **Direcci√≥n de Origen y Destino**| IP remitente y receptor (como direcci√≥n postal).              |
| **Opciones**                   | Opcional, para diagn√≥stico o depuraci√≥n.                        |
| **Datos (Payload)**             | Datos √∫tiles transmitidos (ej. contenido de correo).            |

---

# Uso de Wireshark para el An√°lisis de Tr√°fico de Red

<Aside type="note">
Wireshark es una herramienta esencial para el monitoreo y diagn√≥stico de redes.
</Aside>

## ¬øQu√© es Wireshark?

<Card title="¬øQu√© hace Wireshark?">
Wireshark es un analizador de protocolos de red de c√≥digo abierto con una interfaz gr√°fica de usuario (GUI) que facilita la visualizaci√≥n y el an√°lisis de tr√°fico de red.  
Aunque cuenta con muchas funciones avanzadas, en esta secci√≥n se aborda su uso b√°sico enfocado en el <strong>filtrado de paquetes</strong>.
</Card>

## Filtros de Visualizaci√≥n

Wireshark permite aplicar **filtros de visualizaci√≥n** para aislar paquetes espec√≠ficos dentro de grandes vol√∫menes de datos capturados.

<CardGrid>
  <Card title="¬øQu√© se puede filtrar?">
  - Protocolos  
  - Direcciones IP  
  - Puertos  
  - Cadenas de texto  
  - Expresiones regulares  
  - Cualquier propiedad de un paquete
  </Card>
</CardGrid>

## Operadores de Comparaci√≥n

<Tabs>
  <div title="Operadores Disponibles">

| Tipo de operador       | S√≠mbolo | Abreviatura |
|------------------------|---------|-------------|
| Igual                  | `==`    | `eq`        |
| No igual               | `!=`    | `ne`        |
| Mayor que              | `>`     | `gt`        |
| Menor que              | `<`     | `lt`        |
| Mayor o igual que      | `>=`    | `ge`        |
| Menor o igual que      | `<=`    | `le`        |

  </div>
  <div title="Consejo">
    <Aside type="tip">
    üí° Puedes combinar operadores con <code>and</code>, <code>or</code> y agrupar expresiones con par√©ntesis para crear filtros m√°s complejos.
    </Aside>
  </div>
</Tabs>

## Operadores Especiales

<CardGrid>
  <Card title="contains">
  Muestra paquetes que contienen una coincidencia exacta de texto.  
  <Code code={`http contains "moved"`} lang="wireshark" title="Filtro con contains" />
  </Card>

  <Card title="matches (regex)">
  Filtra usando expresiones regulares para buscar patrones m√°s complejos.  
  <Code code={`http.request.uri matches ".*login.*"`} lang="wireshark" title="Filtro con regex" />
  </Card>
</CardGrid>

## Barra de Herramientas de Filtrado

<Code code="dns" lang="wireshark" title="Filtro DNS" />

<Aside type="note">
üé® Wireshark asigna <strong>colores</strong> distintos a protocolos, lo cual facilita su identificaci√≥n visual. Puedes personalizarlos.
</Aside>

## Filtrado Com√∫n

<Tabs>
  <div title="Por protocolo">
  <Code code={`dns\nhttp\nftp\nssh\narp\ntelnet\nicmp`} lang="wireshark" title="Protocolos" />
  </div>

  <div title="Por direcci√≥n IP">
  <Code code={`ip.addr == 172.21.224.2\nip.src == 10.10.10.10\nip.dst == 4.4.4.4`} lang="wireshark" title="Direcciones IP" />
  </div>

  <div title="Por direcci√≥n MAC">
  <Code code={`eth.addr == 00:70:f4:23:18:c4`} lang="wireshark" title="MAC Address" />
  </div>

  <div title="Por puerto">
  <Code code={`udp.port == 53\ntcp.port == 25`} lang="wireshark" title="Puertos TCP y UDP" />
  </div>
</Tabs>

## Seguir flujos (Follow Stream)

<Steps>
1. **¬øQu√© hace?**  
   Permite reensamblar flujos de comunicaci√≥n entre dos dispositivos.

2. **¬øPara qu√© sirve?**  
   Es √∫til para inspeccionar solicitudes y respuestas completas entre cliente y servidor, por ejemplo en HTTP.

3. **Ventaja:**  
   Reorganiza los datos capturados en un orden legible y l√≥gico.
</Steps>